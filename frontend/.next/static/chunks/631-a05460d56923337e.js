"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{5556:function(t,a,e){e.d(a,{Z:function(){return h}});var n=e(5893),o=e(7294),l=e(1664),r=e.n(l),i=e(6699),s=e(7414),c=e(9346),u=t=>{let{user:a}=(0,s.a)(),[e,n]=(0,o.useState)(!1),[l,r]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{if(a&&t&&a.id!==t)try{let a=await (0,c.rl)(t);n(a.isFollowing)}catch(t){console.error("Failed to check following status:",t)}})()},[a,t]);let i=async()=>{if(!a){alert("Bạn cần đăng nhập để theo d\xf5i.");return}if(a.id===t){alert("Bạn kh\xf4ng thể theo d\xf5i ch\xednh m\xecnh.");return}r(!0);try{e?(await (0,c.F6)(t),n(!1)):(await (0,c.P_)(t),n(!0))}catch(t){console.error("Failed to follow/unfollow:",t),alert("Đ\xe3 xảy ra lỗi. Vui l\xf2ng thử lại sau.")}finally{r(!1)}};return{isFollowing:e,toggleFollow:i,loading:l}},d=t=>{let{authorId:a}=t,{isFollowing:e,toggleFollow:o,loading:l}=u(a),{user:r}=(0,s.a)();return r&&a&&r.id!==a?(0,n.jsx)("button",{onClick:o,className:"ml-2 text-blue-500",disabled:l,children:e?(0,n.jsx)(i.UDo,{}):(0,n.jsx)(i.cHf,{})}):null},h=t=>{let{author:a}=t;return(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(r(),{href:"/".concat(null==a?void 0:a.username),legacyBehavior:!0,children:(0,n.jsxs)("a",{className:"flex items-center",children:[(0,n.jsx)("img",{src:(null==a?void 0:a.avatar_url)||"/default-avatar.png",alt:"".concat((null==a?void 0:a.name)||"Author"," Avatar"),className:"w-8 h-8 rounded-full mr-2"}),(0,n.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:(null==a?void 0:a.name)||"Unknown Author"})]})}),(0,n.jsx)(d,{authorId:a.id})]})}},7821:function(t,a,e){var n=e(5893),o=e(7294),l=e(2413),r=e(2914),i=e(5480);a.Z=t=>{let{category:a,initialItems:e,onFollowChange:s}=t,[c,u]=(0,o.useState)(e),[d,h]=(0,o.useState)(!1),[m,f]=(0,o.useState)(null);(0,o.useEffect)(()=>{u(e)},[e]);let w=async t=>{h(!0),f(null);try{await (0,l.Eu)(t.id);let a={...t,isFollowing:!0};u(e=>e.map(e=>e.id===t.id?a:e)),s&&s(a)}catch(a){f("Failed to follow ".concat(t.name))}finally{h(!1)}},g=async t=>{h(!0),f(null);try{await (0,l.G6)(t.id);let a={...t,isFollowing:!1};u(e=>e.map(e=>e.id===t.id?a:e)),s&&s(a)}catch(a){f("Failed to unfollow ".concat(t.name))}finally{h(!1)}};return(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-gray-800",children:a}),m&&(0,n.jsx)("div",{className:"text-red-500 mb-4 animate-pulse",children:m}),(0,n.jsx)("ul",{children:c.map(t=>(0,n.jsxs)(i.E.li,{className:"flex justify-between items-center mb-4 p-4 bg-white rounded-lg shadow hover:shadow-md transition-shadow duration-300",whileHover:{scale:1.02},children:[(0,n.jsx)("span",{className:"text-lg text-gray-700",children:t.name}),(0,n.jsxs)(i.E.button,{onClick:()=>t.isFollowing?g(t):w(t),className:"flex items-center px-4 py-2 rounded-full font-medium transition-colors duration-300 ".concat(t.isFollowing?"bg-red-500 text-white hover:bg-red-600":"bg-blue-500 text-white hover:bg-blue-600"),disabled:d,whileTap:{scale:.95},children:[t.isFollowing?(0,n.jsx)(r.iFH,{className:"mr-2 text-sm"}):(0,n.jsx)(r.wEH,{className:"mr-2 text-sm"}),t.isFollowing?"Unfollow":"Follow"]})]},t.id))})]})}},1087:function(t,a,e){var n=e(5893);e(7294);let o=t=>{let a=Math.floor((new Date-new Date(t))/1e3),e=Math.floor(a/86400);return e>=1?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):(e=Math.floor(a/3600))>=1?"".concat(e," hour").concat(1===e?"":"s"," ago"):(e=Math.floor(a/60))>=1?"".concat(e," minute").concat(1===e?"":"s"," ago"):"just now"};a.Z=t=>{let{timestamp:a}=t;return(0,n.jsx)("p",{className:"text-sm font-medium text-gray-600 mt-1 inline-flex items-center space-x-1",children:(0,n.jsx)("span",{children:o(a)})})}},7187:function(t,a,e){e.d(a,{Lm:function(){return r},SI:function(){return l},UI:function(){return i},up:function(){return o}});var n=e(4716);let o=async t=>(await n.Z.post("/api/bookmarks",{post_id:t})).data,l=async t=>(await n.Z.post("/api/bookmarks/unbookmark",{post_id:t})).data,r=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,e=(await n.Z.get("/api/bookmarks?page=".concat(t,"&limit=").concat(a))).data;if(!e||!Array.isArray(e.data)||"number"!=typeof e.total_count)throw Error("Invalid response format for getReadingList");return{username:"pdhoang91",posts:e.data,totalCount:e.total_count}},i=async t=>(await n.Z.get("/api/bookmarks/isBookmarked/".concat(t))).data},9346:function(t,a,e){e.d(a,{F6:function(){return i},P_:function(){return r},QL:function(){return s},kS:function(){return c},rl:function(){return l}});var n=e(4716),o=e(6607);let l=async t=>(await n.Z.get("/api/follow/status/".concat(t))).data,r=async t=>(await n.Z.post("/api/follow",{following_id:t})).data,i=async t=>(await n.Z.delete("/api/unfollow/".concat(t))).data,s=async()=>{try{let t=await o.Z.get("/follow/writers");return console.log("response1",t),t.data.data}catch(t){throw console.error("Error fetching writers:",t),t}},c=async()=>{try{let t=await o.Z.get("/follow/topics");return console.log("response2",t),t.data.data}catch(t){throw console.error("Error fetching topics:",t),t}}}}]);