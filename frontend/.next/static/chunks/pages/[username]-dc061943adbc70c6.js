(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[280],{3142:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[username]",function(){return s(1801)}])},5434:function(e,t,s){"use strict";s.d(t,{Z:function(){return w}});var a=s(5893),r=s(7294),n=s(1664),l=s.n(n),o=s(2914),i=s(1409),c=s(8997),d=s(2072),u=s(4608),p=s(5556),h=s(7414),m=s(8070),x=s(760),f=s(7559),g=s(7636),v=s(4052),j=()=>{let[e,t]=(0,r.useState)({copied:!1,error:null});return{copyLink:async e=>{try{await navigator.clipboard.writeText(e),t({copied:!0,error:null}),setTimeout(()=>t({copied:!1,error:null}),2e3)}catch(e){console.error("Failed to copy:",e),t({copied:!1,error:"Kh\xf4ng thể sao ch\xe9p đường dẫn."})}},shareOnTwitter:(e,t)=>{let s="https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e),"&text=").concat(encodeURIComponent(t));window.open(s,"_blank","noopener,noreferrer")},shareOnFacebook:e=>{let t="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(e));window.open(t,"_blank","noopener,noreferrer")},shareOnLinkedIn:(e,t)=>{let s="https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(e),"&title=").concat(encodeURIComponent(t));window.open(s,"_blank","noopener,noreferrer")},shareStatus:e}},b=e=>{let{shareUrl:t,title:s,onClose:r}=e;console.log("shareUrl",t),console.log("title",s);let{copyLink:n,shareOnTwitter:l,shareOnFacebook:i,shareOnLinkedIn:c,shareStatus:d}=j();return(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-white border rounded shadow-lg z-10 transition-transform duration-200 transform opacity-100 scale-100",children:(0,a.jsxs)("ul",{className:"py-1",children:[(0,a.jsxs)("li",{children:[(0,a.jsxs)("button",{onClick:()=>{n(t)},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,a.jsx)(v.C3L,{className:"mr-2"})," Copy Link"]}),d.copied&&(0,a.jsx)("span",{className:"text-green-500 text-sm px-4",children:"Đ\xe3 sao ch\xe9p!"}),d.error&&(0,a.jsx)("span",{className:"text-red-500 text-sm px-4",children:d.error})]}),(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>{l(t,s),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,a.jsx)(o.fWC,{className:"mr-2 text-blue-400"})," Share on X"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>{i(t),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,a.jsx)(o.tBk,{className:"mr-2 text-blue-600"})," Share on Facebook"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>{c(t,s),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,a.jsx)(o.BUd,{className:"mr-2 text-blue-700"})," Share on LinkedIn"]})})]})})},y=s(1087),w=e=>{let{post:t}=e;if(!t)return(0,a.jsx)("div",{children:"Đang tải b\xe0i viết..."});let{clapsCount:s,loading:n,mutate:v}=(0,m.B)("post",t.id),{user:j}=(0,h.a)(),{isBookmarked:w,toggleBookmark:N,loading:k}=(0,f.Z)(t.id),[C,P]=(0,r.useState)(!1),[_,E]=(0,r.useState)(!1),S=(0,r.useRef)(),{comments:U,totalCommentReply:R,totalCount:Z,isLoading:I,isError:F,mutate:L}=(0,g.M)(t.id,!0,1,10);(0,r.useEffect)(()=>{let e=e=>{S.current&&!S.current.contains(e.target)&&E(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let A=async()=>{if(!j){alert("Bạn cần đăng nhập để clap.");return}try{console.log("clapPost:",t.id),await (0,x.nl)(t.id),v()}catch(e){console.error("Failed to clap:",e),v(),alert("Đ\xe3 xảy ra lỗi khi clap. Vui l\xf2ng thử lại sau.")}},B="http://localhost:3000/p/".concat(t.title_name);return(0,a.jsx)("div",{className:"rounded-lg p-6 mb-6 bg-white transition-shadow duration-300",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,a.jsxs)("div",{className:"w-full md:w-2/3 pr-0 md:pr-4",children:[(0,a.jsx)(p.Z,{author:t.user}),(0,a.jsx)(l(),{href:"/p/".concat(t.title_name),children:(0,a.jsx)("h5",{className:"text-lg text-gray-800 hover:text-blue-600 transition-colors duration-200 line-clamp-2",children:t.title})}),(0,a.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:(0,a.jsx)(u.Z,{html:t.preview_content,maxLength:200})}),(0,a.jsx)(d.Z,{postId:t.id}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between mt-4 space-y-2 md:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:A,className:"flex items-center text-gray-600 hover:text-red-500 transition-colors","aria-label":"Clap for this post",children:[(0,a.jsx)(i.sOS,{className:"mr-1"})," ",s]}),(0,a.jsxs)("button",{onClick:()=>{P(e=>!e)},className:"flex items-center text-gray-600 hover:text-blue-500 transition-colors","aria-label":"View comments",children:[(0,a.jsx)(i.RcG,{className:"mr-1"})," ",R]}),(0,a.jsxs)("span",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(o.dSq,{className:"mr-1"})," ",t.views]}),(0,a.jsx)(y.Z,{timestamp:t.created_at})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:N,className:"flex items-center text-gray-600 hover:text-yellow-500 transition-colors",disabled:k,"aria-label":"Bookmark this post",children:[w?(0,a.jsx)(o.VF9,{className:"mr-1"}):(0,a.jsx)(o.mCg,{className:"mr-1"}),k&&(0,a.jsx)("span",{className:"text-sm",children:"..."})]}),(0,a.jsxs)("div",{ref:S,className:"relative",children:[(0,a.jsx)("button",{onClick:()=>{E(e=>!e)},className:"flex items-center text-gray-600 hover:text-green-500 transition-colors","aria-label":"Share this post",children:(0,a.jsx)(o.PPi,{className:"mr-1"})}),_&&(0,a.jsx)(b,{shareUrl:B,title:t.title,onClose:()=>E(!1)})]})]})]}),(0,a.jsx)(c.Z,{isOpen:C,onClose:()=>{P(!1)},postId:t.id,user:j})]}),(0,a.jsx)("div",{className:"w-full md:w-1/3 mt-4 md:mt-0",children:t.image_title&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(l(),{href:"/p/".concat(t.title_name),children:(0,a.jsx)("img",{src:t.image_title,alt:t.title,className:"h-48 w-full object-cover rounded transform hover:scale-105 transition-transform duration-300"})})})})]})})}},1415:function(e,t,s){"use strict";var a=s(5893);t.Z=()=>(0,a.jsx)("aside",{className:"border-gray-300 p-4"})},4608:function(e,t,s){"use strict";var a=s(5893);s(7294);var r=s(9238),n=s.n(r);t.Z=e=>{let{html:t,maxLength:s=200}=e,r=n().sanitize(t),l=e=>{if(!e)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""};return(0,a.jsx)("span",{children:(e=>{let t=l(e);return t.length>s?t.substring(0,s)+"...":t})(r)})}},1801:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var a=s(5893),r=s(7294),n=s(1163),l=s(7414),o=s(9021),i=e=>{let[t,s]=(0,r.useState)(null),[a,n]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[u,p]=(0,r.useState)(null);return(0,r.useEffect)(()=>{e&&(async()=>{try{let t=await (0,o.YI)(e);s(t);let a=await (0,o.bg)(e,1,10);n(a.posts||[])}catch(e){p("Failed to load public profile.")}finally{d(!1)}})()},[e]),{profile:t,posts:a,bookmarks:l,loading:c,error:u}},c=()=>{let{user:e,setUser:t}=(0,l.a)(),[s,a]=(0,r.useState)(null),[n,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[u,p]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(e){let t=async()=>{try{let t=await (0,o.ww)(e.id);i(t)}catch(e){console.error("Failed to fetch user posts:",e),m("Failed to load user posts.")}finally{p(!1)}};(async()=>{try{let e=await (0,o.et)();a(e)}catch(e){console.error("Failed to fetch user profile:",e),m("Failed to load profile.")}finally{d(!1)}})(),t()}},[e]),{profile:s,posts:n,loading:c||u,error:h,updateProfile:async s=>{try{let r=await (0,o.Lj)(e.id,s);a(r),t(r),alert("Profile updated successfully!")}catch(e){throw console.error("Failed to update profile:",e),alert("Failed to update profile."),e}},setPosts:i}},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"YourPosts",[t,s]=(0,r.useState)(e);return{activeTab:t,navigateToTab:e=>{s(e)}}},u=s(5480),p=e=>{let{avatarUrl:t,name:s,phone:r,dob:n,onUpdate:l}=e;return(0,a.jsxs)(u.E.div,{className:"mb-6 flex items-center p-4 bg-white rounded-lg",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:t||"/default-avatar.png",alt:"Avatar",className:"w-32 h-32 rounded-full mr-4 object-cover"}),l&&(0,a.jsx)("button",{onClick:l,className:"absolute bottom-0 right-0 bg-blue-400 text-white rounded-full p-2 hover:bg-blue-500 transition",title:"Update Avatar",children:"✎"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:s}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Phone: ",r||"N/A"]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Date of Birth: ",n||"N/A"]})]})]})},h=s(2914),m=s(3784),x=e=>{let{userProfile:t,onUpdate:s,onCancel:n}=e,[l,o]=(0,r.useState)(t.name||""),[i,c]=(0,r.useState)(t.phone||""),[d,p]=(0,r.useState)(t.dob||""),[x,f]=(0,r.useState)(t.avatar_url||""),[g,v]=(0,r.useState)(!1),j=(0,r.useRef)(null),b=async e=>{let t=e.target.files[0];if(t){v(!0);try{let e=await (0,m.Ix)(t);f(e)}catch(e){console.error("Failed to upload avatar:",e),alert("Kh\xf4ng thể tải l\xean h\xecnh ảnh. Vui l\xf2ng thử lại.")}finally{v(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50 z-50",children:(0,a.jsxs)(u.E.div,{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-lg",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300},children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Update Profile"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s({name:l,phone:i,dob:d,avatar_url:x})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("img",{src:x,alt:"Avatar",className:"w-16 h-16 rounded-full object-cover"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{j.current&&j.current.click()},className:"bg-blue-500 text-white px-3 py-2 rounded hover:bg-blue-600 transition flex items-center","aria-label":"Upload Avatar",title:"Tải l\xean avatar",children:g?(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.DUB,{size:16,className:"mr-2"}),"Upload Avatar"]})}),(0,a.jsx)("input",{type:"file",accept:"image/*",ref:j,onChange:b,className:"hidden"})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDC64"}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Name",required:!0})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCDE"}),(0,a.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Phone Number"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83C\uDF82"}),(0,a.jsx)("input",{type:"date",value:d,onChange:e=>p(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Update"}),(0,a.jsx)("button",{type:"button",onClick:n,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 transition",children:"Cancel"})]})]})]})})},f=s(5434),g=e=>{let{posts:t}=e;return Array.isArray(t)?(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsx)(f.Z,{post:e},e.id))}):(0,a.jsx)("div",{children:"No posts available."})},v=s(9820),j=s(7187);let b=()=>(0,j.Lm)(1,1e3);var y=()=>{let{data:e,error:t}=(0,v.ZP)("/api/bookmarks",b);if(t)return(0,a.jsx)("div",{children:"Kh\xf4ng thể tải danh s\xe1ch đọc."});if(!e)return(0,a.jsx)("div",{children:"Đang tải danh s\xe1ch đọc..."});let{posts:s,totalCount:r}=e;return 0===s.length?(0,a.jsx)("div",{children:"Bạn chưa bookmark b\xe0i viết n\xe0o."}):(0,a.jsx)("div",{children:s.map(e=>(0,a.jsx)(f.Z,{post:e},e.id))})},w=()=>(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsx)(y,{})}),N=s(1415);s(9346);var k=()=>{let{username:e}=(0,n.useRouter)().query,{user:t,loading:s,mutate:o}=(0,l.a)(),{activeTab:h,navigateToTab:m,setActiveTab:f}=d(),[v,j]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&e?j(t.username===e):j(!1)},[t,e]),(0,r.useEffect)(()=>{v?m("YourPosts"):m("UserPosts")},[v]);let{profile:k,posts:C,bookmarks:P,loading:_,error:E}=i(e),{profile:S,posts:U,readingList:R,loading:Z,error:I,updateProfile:F}=c(),L=async e=>{try{await F(e),y(!1),o&&await o()}catch(e){console.error("Failed to update profile:",e),alert("Cập nhật hồ sơ thất bại. Vui l\xf2ng thử lại.")}},A=v?S:k,B=v?U:C,D=v?R:P,T=v?Z:_,Y=v?I:E;return T||s?(0,a.jsx)("div",{className:"container mx-auto p-4",children:"Loading..."}):Y?(0,a.jsx)("div",{className:"container mx-auto p-4 text-red-500",children:Y}):(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,a.jsx)("div",{className:"lg:w-1/12 p-4 h-screen sticky top-0 overflow-auto hidden lg:block",children:(0,a.jsx)(N.Z,{})}),(0,a.jsxs)("div",{className:"lg:w-10/12 p-4",children:[(0,a.jsx)(p,{avatarUrl:null==A?void 0:A.avatar_url,name:null==A?void 0:A.name,phone:null==A?void 0:A.phone,dob:null==A?void 0:A.dob,onUpdate:v?()=>y(!0):null}),(0,a.jsxs)("div",{className:"flex space-x-4 my-4 border-b",children:[(0,a.jsx)("button",{onClick:()=>m(v?"YourPosts":"UserPosts"),className:"p-2 transition-colors ".concat(h===(v?"YourPosts":"UserPosts")?"text-blue-500 border-b-2 border-blue-500":"text-gray-600 hover:text-blue-400"),children:v?"Your Posts":"User's Posts"}),(0,a.jsx)("button",{onClick:()=>m(v?"YourReading":"Bookmarks"),className:"p-2 transition-colors ".concat(h===(v?"YourReading":"Bookmarks")?"text-blue-500 border-b-2 border-blue-500":"text-gray-600 hover:text-blue-400"),children:v?"Your Reading":"Bookmarked"})]}),(0,a.jsxs)(u.E.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},children:[h===(v?"YourPosts":"UserPosts")&&(0,a.jsx)(g,{posts:B||[]}),h===(v?"YourReading":"Bookmarks")&&(0,a.jsx)(w,{bookmarks:D})]},h),v&&b&&(0,a.jsx)(x,{userProfile:A,onUpdate:L,onCancel:()=>y(!1)})]}),(0,a.jsx)("div",{className:"lg:w-1/12 p-8 hidden lg:block"})]})}},3784:function(e,t,s){"use strict";s.d(t,{CP:function(){return o},Ix:function(){return p},Jq:function(){return n},KY:function(){return d},Td:function(){return u},a2:function(){return c},qb:function(){return l},u_:function(){return i}});var a=s(4716),r=s(6607);let n=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=(await r.Z.get("/posts?page=".concat(e,"&limit=").concat(t))).data;if(!s||!Array.isArray(s.data)||"number"!=typeof s.total_count)throw Error("Invalid response format for getPosts");return{posts:s.data,totalCount:s.total_count}},l=async e=>(await a.Z.post("/api/posts",e)).data,o=async(e,t)=>(await a.Z.put("/api/posts/".concat(e),t)).data,i=async e=>(await r.Z.get("/posts/".concat(e))).data.data,c=async e=>(await r.Z.get("/p/".concat(e))).data.data,d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=(await a.Z.get("/api/following/posts?page=".concat(e,"&limit=").concat(t))).data;if(!s||!Array.isArray(s.data)||"number"!=typeof s.total_count)throw Error("Invalid response format for getFollowingPosts");return{posts:s.data,totalCount:s.total_count}},u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=(await r.Z.get("/categories/".concat(encodeURIComponent(e),"/posts?page=").concat(t,"&limit=").concat(s))).data;if(!a||!Array.isArray(a.data)||"number"!=typeof a.total_count)throw Error("Invalid response format for getPostsByCategory");return{posts:a.data,totalCount:a.total_count}},p=async e=>{let t=new FormData;t.append("image",e);let s=await r.Z.post("/images/upload",t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("response.data.url",s.data.url),s.data.url}},3114:function(e,t,s){"use strict";s.d(t,{M:function(){return g}});var a=s(5893),r=s(7294),n=s(240),l=s(6681),o=s(6014);class i extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function c({children:e,isPresent:t}){let s=(0,r.useId)(),n=(0,r.useRef)(null),l=(0,r.useRef)({width:0,height:0,top:0,left:0}),{nonce:c}=(0,r.useContext)(o._);return(0,r.useInsertionEffect)(()=>{let{width:e,height:a,top:r,left:o}=l.current;if(t||!n.current||!e||!a)return;n.current.dataset.motionPopId=s;let i=document.createElement("style");return c&&(i.nonce=c),document.head.appendChild(i),i.sheet&&i.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            top: ${r}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(i)}},[t]),(0,a.jsx)(i,{isPresent:t,childRef:n,sizeRef:l,children:r.cloneElement(e,{ref:n})})}let d=({children:e,initial:t,isPresent:s,onExitComplete:o,custom:i,presenceAffectsLayout:d,mode:p})=>{let h=(0,l.h)(u),m=(0,r.useId)(),x=(0,r.useCallback)(e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;o&&o()},[h,o]),f=(0,r.useMemo)(()=>({id:m,initial:t,isPresent:s,custom:i,onExitComplete:x,register:e=>(h.set(e,!1),()=>h.delete(e))}),d?[Math.random(),x]:[s,x]);return(0,r.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[s]),r.useEffect(()=>{s||h.size||!o||o()},[s]),"popLayout"===p&&(e=(0,a.jsx)(c,{isPresent:s,children:e})),(0,a.jsx)(n.O.Provider,{value:f,children:e})};function u(){return new Map}var p=s(5364),h=s(5487);let m=e=>e.key||"";function x(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}var f=s(8868);let g=({children:e,exitBeforeEnter:t,custom:s,initial:n=!0,onExitComplete:o,presenceAffectsLayout:i=!0,mode:c="sync"})=>{(0,h.k)(!t,"Replace exitBeforeEnter with mode='wait'");let u=(0,r.useMemo)(()=>x(e),[e]),g=u.map(m),v=(0,r.useRef)(!0),j=(0,r.useRef)(u),b=(0,l.h)(()=>new Map),[y,w]=(0,r.useState)(u),[N,k]=(0,r.useState)(u);(0,f.L)(()=>{v.current=!1,j.current=u;for(let e=0;e<N.length;e++){let t=m(N[e]);g.includes(t)?b.delete(t):!0!==b.get(t)&&b.set(t,!1)}},[N,g.length,g.join("-")]);let C=[];if(u!==y){let e=[...u];for(let t=0;t<N.length;t++){let s=N[t],a=m(s);g.includes(a)||(e.splice(t,0,s),C.push(s))}"wait"===c&&C.length&&(e=C),k(x(e)),w(u);return}let{forceRender:P}=(0,r.useContext)(p.p);return(0,a.jsx)(a.Fragment,{children:N.map(e=>{let t=m(e),r=u===N||g.includes(t);return(0,a.jsx)(d,{isPresent:r,initial:(!v.current||!!n)&&void 0,custom:r?void 0:s,presenceAffectsLayout:i,mode:c,onExitComplete:r?void 0:()=>{if(!b.has(t))return;b.set(t,!0);let e=!0;b.forEach(t=>{t||(e=!1)}),e&&(null==P||P(),k(j.current),o&&o())},children:e},t)})})}}},function(e){e.O(0,[445,237,778,617,152,197,889,238,472,888,774,179],function(){return e(e.s=3142)}),_N_E=e.O()}]);