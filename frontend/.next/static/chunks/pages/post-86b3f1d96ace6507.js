(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{284:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/post",function(){return s(1508)}])},5434:function(e,t,s){"use strict";s.d(t,{Z:function(){return w}});var n=s(5893),r=s(7294),a=s(1664),l=s.n(a),i=s(2914),o=s(1409),c=s(8997),d=s(2072),x=s(4608),m=s(5556),u=s(7414),h=s(8070),p=s(760),f=s(7559),j=s(7636),g=s(4052),v=()=>{let[e,t]=(0,r.useState)({copied:!1,error:null});return{copyLink:async e=>{try{await navigator.clipboard.writeText(e),t({copied:!0,error:null}),setTimeout(()=>t({copied:!1,error:null}),2e3)}catch(e){console.error("Failed to copy:",e),t({copied:!1,error:"Kh\xf4ng thể sao ch\xe9p đường dẫn."})}},shareOnTwitter:(e,t)=>{let s="https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e),"&text=").concat(encodeURIComponent(t));window.open(s,"_blank","noopener,noreferrer")},shareOnFacebook:e=>{let t="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(e));window.open(t,"_blank","noopener,noreferrer")},shareOnLinkedIn:(e,t)=>{let s="https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(e),"&title=").concat(encodeURIComponent(t));window.open(s,"_blank","noopener,noreferrer")},shareStatus:e}},N=e=>{let{shareUrl:t,title:s,onClose:r}=e;console.log("shareUrl",t),console.log("title",s);let{copyLink:a,shareOnTwitter:l,shareOnFacebook:o,shareOnLinkedIn:c,shareStatus:d}=v();return(0,n.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-white border rounded shadow-lg z-10 transition-transform duration-200 transform opacity-100 scale-100",children:(0,n.jsxs)("ul",{className:"py-1",children:[(0,n.jsxs)("li",{children:[(0,n.jsxs)("button",{onClick:()=>{a(t)},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(g.C3L,{className:"mr-2"})," Copy Link"]}),d.copied&&(0,n.jsx)("span",{className:"text-green-500 text-sm px-4",children:"Đ\xe3 sao ch\xe9p!"}),d.error&&(0,n.jsx)("span",{className:"text-red-500 text-sm px-4",children:d.error})]}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{l(t,s),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(i.fWC,{className:"mr-2 text-blue-400"})," Share on X"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{o(t),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(i.tBk,{className:"mr-2 text-blue-600"})," Share on Facebook"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{c(t,s),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(i.BUd,{className:"mr-2 text-blue-700"})," Share on LinkedIn"]})})]})})},b=s(1087),w=e=>{let{post:t}=e;if(!t)return(0,n.jsx)("div",{children:"Đang tải b\xe0i viết..."});let{clapsCount:s,loading:a,mutate:g}=(0,h.B)("post",t.id),{user:v}=(0,u.a)(),{isBookmarked:w,toggleBookmark:y,loading:k}=(0,f.Z)(t.id),[C,_]=(0,r.useState)(!1),[Z,S]=(0,r.useState)(!1),L=(0,r.useRef)(),{comments:E,totalCommentReply:I,totalCount:R,isLoading:U,isError:O,mutate:T}=(0,j.M)(t.id,!0,1,10);(0,r.useEffect)(()=>{let e=e=>{L.current&&!L.current.contains(e.target)&&S(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let B=async()=>{if(!v){alert("Bạn cần đăng nhập để clap.");return}try{console.log("clapPost:",t.id),await (0,p.nl)(t.id),g()}catch(e){console.error("Failed to clap:",e),g(),alert("Đ\xe3 xảy ra lỗi khi clap. Vui l\xf2ng thử lại sau.")}},F="http://localhost:3000/p/".concat(t.title_name);return(0,n.jsx)("div",{className:"rounded-lg p-6 mb-6 bg-white transition-shadow duration-300",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,n.jsxs)("div",{className:"w-full md:w-2/3 pr-0 md:pr-4",children:[(0,n.jsx)(m.Z,{author:t.user}),(0,n.jsx)(l(),{href:"/p/".concat(t.title_name),children:(0,n.jsx)("h5",{className:"text-lg text-gray-800 hover:text-blue-600 transition-colors duration-200 line-clamp-2",children:t.title})}),(0,n.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:(0,n.jsx)(x.Z,{html:t.preview_content,maxLength:200})}),(0,n.jsx)(d.Z,{postId:t.id}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between mt-4 space-y-2 md:space-y-0",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{onClick:B,className:"flex items-center text-gray-600 hover:text-red-500 transition-colors","aria-label":"Clap for this post",children:[(0,n.jsx)(o.sOS,{className:"mr-1"})," ",s]}),(0,n.jsxs)("button",{onClick:()=>{_(e=>!e)},className:"flex items-center text-gray-600 hover:text-blue-500 transition-colors","aria-label":"View comments",children:[(0,n.jsx)(o.RcG,{className:"mr-1"})," ",I]}),(0,n.jsxs)("span",{className:"flex items-center text-gray-600",children:[(0,n.jsx)(i.dSq,{className:"mr-1"})," ",t.views]}),(0,n.jsx)(b.Z,{timestamp:t.created_at})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{onClick:y,className:"flex items-center text-gray-600 hover:text-yellow-500 transition-colors",disabled:k,"aria-label":"Bookmark this post",children:[w?(0,n.jsx)(i.VF9,{className:"mr-1"}):(0,n.jsx)(i.mCg,{className:"mr-1"}),k&&(0,n.jsx)("span",{className:"text-sm",children:"..."})]}),(0,n.jsxs)("div",{ref:L,className:"relative",children:[(0,n.jsx)("button",{onClick:()=>{S(e=>!e)},className:"flex items-center text-gray-600 hover:text-green-500 transition-colors","aria-label":"Share this post",children:(0,n.jsx)(i.PPi,{className:"mr-1"})}),Z&&(0,n.jsx)(N,{shareUrl:F,title:t.title,onClose:()=>S(!1)})]})]})]}),(0,n.jsx)(c.Z,{isOpen:C,onClose:()=>{_(!1)},postId:t.id,user:v})]}),(0,n.jsx)("div",{className:"w-full md:w-1/3 mt-4 md:mt-0",children:t.image_title&&(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(l(),{href:"/p/".concat(t.title_name),children:(0,n.jsx)("img",{src:t.image_title,alt:t.title,className:"h-48 w-full object-cover rounded transform hover:scale-105 transition-transform duration-300"})})})})]})})}},8818:function(e,t,s){"use strict";var n=s(5893);s(7294);var r=s(5434),a=s(8533);t.Z=e=>{let{posts:t,isLoading:s,isError:l,setSize:i,isReachingEnd:o}=e;return t?l?(0,n.jsx)("div",{className:"text-red-500",children:"Kh\xf4ng thể tải b\xe0i viết"}):s&&0===t.length?(0,n.jsx)("div",{children:"Đang tải..."}):(0,n.jsx)(a.Z,{dataLength:t.length,next:()=>{o||s||i(e=>e+1)},hasMore:!o,loader:(0,n.jsx)("div",{className:"text-center py-4",children:"Đang tải th\xeam b\xe0i viết..."}),endMessage:(0,n.jsx)("p",{className:"text-center py-4 text-gray-500"}),children:(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4",children:t.map(e=>(0,n.jsx)(r.Z,{post:e},e.id))})}):(0,n.jsx)("div",{children:"Đang tải b\xe0i viết..."})}},1415:function(e,t,s){"use strict";var n=s(5893);t.Z=()=>(0,n.jsx)("aside",{className:"border-gray-300 p-4"})},4608:function(e,t,s){"use strict";var n=s(5893);s(7294);var r=s(9238),a=s.n(r);t.Z=e=>{let{html:t,maxLength:s=200}=e,r=a().sanitize(t),l=e=>{if(!e)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""};return(0,n.jsx)("span",{children:(e=>{let t=l(e);return t.length>s?t.substring(0,s)+"...":t})(r)})}},1508:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var n=s(5893),r=s(8818),a=s(1415),l=s(7294),i=s(1163),o=()=>{let[e,t]=(0,l.useState)(""),s=(0,i.useRouter)();return(0,n.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e.trim()&&s.push("/?search=".concat(e))},className:"flex mb-4",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search posts...",value:e,onChange:e=>t(e.target.value),className:"flex-grow p-2 border rounded-l"}),(0,n.jsx)("button",{type:"submit",className:"p-2 rounded-r",children:"Search"})]})},c=()=>{let{search:e}=(0,i.useRouter)().query;return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(a.Z,{}),(0,n.jsxs)("div",{className:"w-3/4 p-4",children:[(0,n.jsx)(o,{}),(0,n.jsx)(r.Z,{searchQuery:e})]})]})}}},function(e){e.O(0,[445,237,778,617,152,197,889,238,883,472,888,774,179],function(){return e(e.s=284)}),_N_E=e.O()}]);