(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2774:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return r(5971)}])},5556:function(t,e,r){"use strict";r.d(e,{Z:function(){return h}});var a=r(5893),n=r(7294),s=r(1664),o=r.n(s),l=r(6699),i=r(7414),c=r(9346),d=t=>{let{user:e}=(0,i.a)(),[r,a]=(0,n.useState)(!1),[s,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{if(e&&t&&e.id!==t)try{let e=await (0,c.rl)(t);a(e.isFollowing)}catch(t){console.error("Failed to check following status:",t)}})()},[e,t]);let l=async()=>{if(!e){alert("Bạn cần đăng nhập để theo d\xf5i.");return}if(e.id===t){alert("Bạn kh\xf4ng thể theo d\xf5i ch\xednh m\xecnh.");return}o(!0);try{r?(await (0,c.F6)(t),a(!1)):(await (0,c.P_)(t),a(!0))}catch(t){console.error("Failed to follow/unfollow:",t),alert("Đ\xe3 xảy ra lỗi. Vui l\xf2ng thử lại sau.")}finally{o(!1)}};return{isFollowing:r,toggleFollow:l,loading:s}},u=t=>{let{authorId:e}=t,{isFollowing:r,toggleFollow:n,loading:s}=d(e),{user:o}=(0,i.a)();return o&&e&&o.id!==e?(0,a.jsx)("button",{onClick:n,className:"ml-2 text-blue-500",disabled:s,children:r?(0,a.jsx)(l.UDo,{}):(0,a.jsx)(l.cHf,{})}):null},h=t=>{let{author:e}=t;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o(),{href:"/".concat(null==e?void 0:e.username),legacyBehavior:!0,children:(0,a.jsxs)("a",{className:"flex items-center",children:[(0,a.jsx)("img",{src:(null==e?void 0:e.avatar_url)||"/default-avatar.png",alt:"".concat((null==e?void 0:e.name)||"Author"," Avatar"),className:"w-8 h-8 rounded-full mr-2"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:(null==e?void 0:e.name)||"Unknown Author"})]})}),(0,a.jsx)(u,{authorId:e.id})]})}},1415:function(t,e,r){"use strict";var a=r(5893);e.Z=()=>(0,a.jsx)("aside",{className:"border-gray-300 p-4"})},8148:function(t,e,r){"use strict";r.d(e,{Z:function(){return E}});var a=r(5893);r(7294);var n=r(9820),s=r(6607);let o=async()=>(await s.Z.get("/topics/recommended")).data.data,l=()=>{let{data:t,error:e}=(0,n.ZP)("/topics/recommended",o);return{recommendedTopics:t,isLoading:!e&&!t,isError:e}};var i=r(1664),c=r.n(i),d=r(1163),u=t=>{let{onClick:e,className:r="",children:n="see more"}=t;return(0,a.jsx)("button",{onClick:e,className:"mt-4 inline-block px-2 py-1 border border-gray-300 text-gray-500 text-sm rounded-full text-center transition-colors hover:bg-gray-100 ".concat(r),children:n})},h=()=>{let{recommendedTopics:t,isLoading:e,isError:r}=l(),n=(0,d.useRouter)();return r?(0,a.jsx)("div",{className:"text-red-500",children:"Kh\xf4ng thể tải chủ đề được đề xuất"}):e?(0,a.jsx)("div",{children:"Đang tải..."}):(0,a.jsxs)("div",{className:"p-4 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Đề Xuất"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(t=>(0,a.jsx)(c(),{href:"/category/".concat(encodeURIComponent(t.name)),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm hover:bg-blue-200 transition-colors",children:t.name},t.id))}),t.length>5&&(0,a.jsx)(u,{onClick:()=>{n.push("/suggestion")}})]})},m=r(6067);let x=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,{data:r,error:a}=(0,n.ZP)("/categories_top",()=>(0,m.cd)(t,e),{revalidateOnMount:!0});return{categories:r?r.categories:[],totalCount:r?r.totalCount:0,isLoading:!a&&!r,isError:a}};var p=r(2914);let g={Technology:(0,a.jsx)(p.tvD,{}),Literature:(0,a.jsx)(p.Mp$,{}),Music:(0,a.jsx)(p.HcQ,{}),Movies:(0,a.jsx)(p.rHK,{})};var f=()=>{let{categories:t,isLoading:e,isError:r}=x(),n=(0,d.useRouter)();return r?(0,a.jsx)("div",{className:"text-red-500",children:"Kh\xf4ng thể tải danh mục"}):e?(0,a.jsx)("div",{children:"Đang tải..."}):(0,a.jsxs)("div",{className:"p-4 rounded-lg shadow",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Danh Mục"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(t=>(0,a.jsxs)(c(),{href:"/category/".concat(encodeURIComponent(t.name)),className:"flex items-center text-gray-700 hover:text-blue-500 transition-colors",children:[(0,a.jsx)("span",{className:"mr-2",children:g[t.name]||(0,a.jsx)(p.Mp$,{})}),t.name]},t.id))}),t.length>3&&(0,a.jsx)(u,{onClick:()=>{n.push("/category")}})]})},v=r(4608),j=r(5556);r(1087);var y=r(5480),w=t=>{let{post:e}=t;return e?(0,a.jsxs)(y.E.div,{className:"flex flex-col sm:flex-row items-start space-x-0 sm:space-x-4 mb-6 p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 bg-white cursor-pointer",whileHover:{scale:1.02},transition:{type:"spring",stiffness:200,damping:20},children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(j.Z,{author:e.user}),(0,a.jsx)(c(),{href:"/p/".concat(e.title_name),children:(0,a.jsx)("h5",{className:"text-lg text-gray-800 hover:text-blue-600 transition-colors duration-200 line-clamp-2",children:e.title})}),(0,a.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:(0,a.jsx)(v.Z,{html:e.preview_content,maxLength:100})})]}),(0,a.jsx)("div",{className:"mt-2 sm:mt-0 flex-shrink-0",children:(0,a.jsx)(p.Dli,{className:"text-blue-500"})})]}):(0,a.jsx)("div",{className:"text-center text-gray-500",children:"Đang tải b\xe0i viết..."})},b=r(7187);let N=async()=>await (0,b.Lm)(1,3);var _=()=>{let{data:t,error:e}=(0,n.ZP)("/api/bookmarks",N),r=(0,d.useRouter)();if(e)return(0,a.jsx)("div",{className:"text-red-500",children:"Kh\xf4ng thể tải danh s\xe1ch đọc."});if(!t)return(0,a.jsx)("div",{children:"Đang tải danh s\xe1ch đọc..."});let{username:s,posts:o,totalCount:l}=t;return o&&0!==o.length?(0,a.jsxs)("div",{children:[o.map(t=>(0,a.jsx)(w,{post:t},t.id)),l>o.length&&(0,a.jsx)(u,{onClick:()=>{r.push("/@".concat(s))}})]}):(0,a.jsx)("div",{className:"text-gray-600",children:"Bạn chưa bookmark b\xe0i viết n\xe0o."})},k=()=>(0,a.jsxs)("div",{className:"p-4 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Danh S\xe1ch Đọc"}),(0,a.jsx)(_,{})]}),C=r(2097),Z=r.n(C),E=()=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(h,{}),(0,a.jsx)("div",{className:Z().categoriesSection,children:(0,a.jsx)(f,{})}),(0,a.jsx)("div",{className:Z().readingListSection,children:(0,a.jsx)(k,{})})]})},4608:function(t,e,r){"use strict";var a=r(5893);r(7294);var n=r(9238),s=r.n(n);e.Z=t=>{let{html:e,maxLength:r=200}=t,n=s().sanitize(e),o=t=>{if(!t)return"";let e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""};return(0,a.jsx)("span",{children:(t=>{let e=o(t);return e.length>r?e.substring(0,r)+"...":e})(n)})}},1087:function(t,e,r){"use strict";var a=r(5893);r(7294);let n=t=>{let e=Math.floor((new Date-new Date(t))/1e3),r=Math.floor(e/86400);return r>=1?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):(r=Math.floor(e/3600))>=1?"".concat(r," hour").concat(1===r?"":"s"," ago"):(r=Math.floor(e/60))>=1?"".concat(r," minute").concat(1===r?"":"s"," ago"):"just now"};e.Z=t=>{let{timestamp:e}=t;return(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 mt-1 inline-flex items-center space-x-1",children:(0,a.jsx)("span",{children:n(e)})})}},5971:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return k}});var a=r(5893),n=r(7294),s=r(1415),o=r(8148),l=r(1664),i=r.n(l),c=r(4608),d=r(5556),u=r(1087),h=t=>{let{post:e}=t;return e?(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start space-x-0 md:space-x-4 mb-6 p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 bg-white cursor-pointer",children:[(0,a.jsxs)("div",{className:"md:w-2/3 pr-0 md:pr-4",children:[(0,a.jsx)(d.Z,{author:e.user}),(0,a.jsx)(i(),{href:"/p/".concat(e.title_name),className:"text-lg font-semibold text-gray-800 hover:underline",children:e.title}),(0,a.jsx)(u.Z,{timestamp:e.created_at}),(0,a.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:(0,a.jsx)(c.Z,{html:e.preview_content,maxLength:100})})]}),e.image_title&&(0,a.jsx)("div",{className:"md:w-1/3 mt-4 md:mt-0",children:(0,a.jsx)(i(),{href:"/p/".concat(e.title_name),children:(0,a.jsx)("img",{src:e.image_title,alt:e.title,className:"h-32 md:h-48 w-full object-cover rounded transform hover:scale-105 transition-transform duration-300"})})})]}):(0,a.jsx)("div",{className:"text-center text-gray-500",children:"Đang tải b\xe0i viết..."})};let m=t=>{let{stories:e,query:r}=t;return e&&0!==e.length?(0,a.jsx)("div",{children:e.map(t=>(0,a.jsx)(h,{post:t},t.id))}):(0,a.jsx)("p",{className:"text-gray-600",children:"Kh\xf4ng t\xecm thấy Stories ph\xf9 hợp."})},x=t=>{let{peoples:e}=t;return e&&0!==e.length?(0,a.jsx)("div",{children:e.map(t=>(0,a.jsxs)("div",{className:"mb-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)(d.Z,{author:{id:t.id,username:t.username,name:t.name,avatar_url:t.avatar_url}}),(0,a.jsx)("p",{className:"text-gray-600",children:t.email}),(0,a.jsx)("p",{className:"text-gray-600",children:t.phone})]},t.id))}):(0,a.jsx)("p",{className:"text-gray-600",children:"Kh\xf4ng t\xecm thấy người ph\xf9 hợp."})};var p=t=>{let{query:e,data:r}=t,[s,o]=(0,n.useState)("Stories");return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex space-x-4 mb-4 border-b",children:["Stories","People"].map(t=>(0,a.jsx)("button",{onClick:()=>o(t),className:"pb-2 font-semibold ".concat(s===t?"border-b-2 border-blue-500 text-blue-500":"text-gray-600 hover:text-blue-500"),children:t},t))}),(0,a.jsx)("div",{children:(()=>{switch(s){case"Stories":return(0,a.jsx)(m,{stories:r.stories,query:e});case"People":return(0,a.jsx)(x,{peoples:r.people,query:e});default:return null}})()})]})},g=()=>(0,a.jsx)("div",{className:"flex justify-center items-center py-4",children:(0,a.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),f=t=>{let{message:e}=t;return(0,a.jsx)("div",{className:"flex justify-center items-center py-4",children:(0,a.jsx)("p",{className:"text-red-500",children:e})})},v=r(1992),j=r(6607);let y=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let a=(await j.Z.get("/search/posts",{params:{q:t,page:e,limit:r}})).data;if(!a||!Array.isArray(a.data)||"number"!=typeof a.total_count)throw Error("Invalid response format for fetchStories");return{posts:a?a.data:[],totalCount:a.total_count}}catch(t){throw console.error("Error fetching stories:",t),t}},w=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let a=(await j.Z.get("/search/people",{params:{q:t,page:e,limit:r}})).data;if(!a||"number"!=typeof a.total_count)throw console.error("Data received:",a),Error("Invalid response format for fetchPeople");return{people:a.data||[],totalCount:a.total_count}}catch(t){throw console.error("Error fetching people:",t),t}},b=t=>{let e=["stories","people"],r=e=>(r,a)=>!t||a&&a.posts.length<10?null:{category:e,page:r+1,limit:10},a=async e=>{let{category:r,page:a,limit:n}=e;try{let e;switch(r){case"stories":return{posts:(e=await y(t,a,n)).posts,totalCount:e.totalCount};case"people":return{people:(e=await w(t,a,n)).people,totalCount:e.totalCount};default:return{posts:[],totalCount:0}}}catch(t){throw console.error("Error fetching data for ".concat(r,":"),t),t}},n=e.map(t=>(0,v.ZP)(r(t),t=>a(t))),s={},o={};return e.forEach((t,e)=>{let r=n[e];s[t]="people"===t?r.data?r.data.flatMap(t=>t.people):[]:r.data?r.data.flatMap(t=>t.posts):[],o[t]=!!r.data&&r.data.length>0&&r.data.some(t=>{var e,r;return(null===(e=t.posts)||void 0===e?void 0:e.length)===10||(null===(r=t.people)||void 0===r?void 0:r.length)===10})}),{data:s,isLoading:n.some(t=>t.isValidating),isError:n.some(t=>t.error),loadMore:t=>{let r=e.indexOf(t);-1!==r&&n[r].setSize(n[r].size+1)},hasMore:o}};var N=t=>{let{query:e}=t,{data:r,isLoading:n,isError:s}=b(e);return n?(0,a.jsx)(g,{}):s?(0,a.jsx)(f,{message:s}):(0,a.jsx)(p,{query:e,data:r})},_=r(1163),k=()=>{let{q:t}=(0,_.useRouter)().query;return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"w-1/12 p-4 h-screen sticky top-0 overflow-auto",children:(0,a.jsx)(s.Z,{})}),(0,a.jsx)("div",{className:"w-8/12 p-4",children:t?(0,a.jsx)(N,{query:t}):(0,a.jsx)("p",{className:"text-gray-600",children:"Vui l\xf2ng nhập từ kh\xf3a t\xecm kiếm."})}),(0,a.jsx)("div",{className:"w-3/12 p-8 border-l border-gray-300",children:(0,a.jsx)(o.Z,{})})]})}},7187:function(t,e,r){"use strict";r.d(e,{Lm:function(){return o},SI:function(){return s},UI:function(){return l},up:function(){return n}});var a=r(4716);let n=async t=>(await a.Z.post("/api/bookmarks",{post_id:t})).data,s=async t=>(await a.Z.post("/api/bookmarks/unbookmark",{post_id:t})).data,o=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=(await a.Z.get("/api/bookmarks?page=".concat(t,"&limit=").concat(e))).data;if(!r||!Array.isArray(r.data)||"number"!=typeof r.total_count)throw Error("Invalid response format for getReadingList");return{username:"pdhoang91",posts:r.data,totalCount:r.total_count}},l=async t=>(await a.Z.get("/api/bookmarks/isBookmarked/".concat(t))).data},6067:function(t,e,r){"use strict";r.d(e,{CP:function(){return n},Td:function(){return o},cd:function(){return s}});var a=r(6607);let n=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=(await a.Z.get("/categories?page=".concat(t,"&limit=").concat(e))).data;if(!r||!Array.isArray(r.data)||"number"!=typeof r.total_count)throw Error("Invalid response format for getCategories");return{categories:r.data,totalCount:r.total_count}}catch(t){throw console.error("Error in getCategories:",t),t}},s=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=(await a.Z.get("/categories_top?page=".concat(t,"&limit=").concat(e))).data;if(!r||!Array.isArray(r.data)||"number"!=typeof r.total_count)throw Error("Invalid response format for getCategories");return{categories:r.data,totalCount:r.total_count}}catch(t){throw console.error("Error in getCategories:",t),t}},o=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let n=(await a.Z.get("/categories/".concat(encodeURIComponent(t),"/posts?page=").concat(e,"&limit=").concat(r))).data;if(!n||!Array.isArray(n.data)||"number"!=typeof n.total_count)throw Error("Invalid response format for getPostsByCategory");return{posts:n.data,totalCount:n.total_count}}catch(t){throw console.error("Error in getPostsByCategory:",t),t}}},9346:function(t,e,r){"use strict";r.d(e,{F6:function(){return l},P_:function(){return o},QL:function(){return i},kS:function(){return c},rl:function(){return s}});var a=r(4716),n=r(6607);let s=async t=>(await a.Z.get("/api/follow/status/".concat(t))).data,o=async t=>(await a.Z.post("/api/follow",{following_id:t})).data,l=async t=>(await a.Z.delete("/api/unfollow/".concat(t))).data,i=async()=>{try{let t=await n.Z.get("/follow/writers");return console.log("response1",t),t.data.data}catch(t){throw console.error("Error fetching writers:",t),t}},c=async()=>{try{let t=await n.Z.get("/follow/topics");return console.log("response2",t),t.data.data}catch(t){throw console.error("Error fetching topics:",t),t}}},2097:function(){}},function(t){t.O(0,[445,237,197,889,238,607,888,774,179],function(){return t(t.s=2774)}),_N_E=t.O()}]);