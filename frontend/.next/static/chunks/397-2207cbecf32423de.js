"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[397],{5434:function(e,t,r){r.d(t,{Z:function(){return b}});var n=r(5893),a=r(7294),s=r(1664),o=r.n(s),l=r(2914),i=r(1409),c=r(8997),d=r(2072),m=r(4608),h=r(5556),u=r(7414),x=r(8070),p=r(760),g=r(7559),f=r(7636),j=r(4052),w=()=>{let[e,t]=(0,a.useState)({copied:!1,error:null});return{copyLink:async e=>{try{await navigator.clipboard.writeText(e),t({copied:!0,error:null}),setTimeout(()=>t({copied:!1,error:null}),2e3)}catch(e){console.error("Failed to copy:",e),t({copied:!1,error:"Kh\xf4ng thể sao ch\xe9p đường dẫn."})}},shareOnTwitter:(e,t)=>{let r="https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e),"&text=").concat(encodeURIComponent(t));window.open(r,"_blank","noopener,noreferrer")},shareOnFacebook:e=>{let t="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(e));window.open(t,"_blank","noopener,noreferrer")},shareOnLinkedIn:(e,t)=>{let r="https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(e),"&title=").concat(encodeURIComponent(t));window.open(r,"_blank","noopener,noreferrer")},shareStatus:e}},y=e=>{let{shareUrl:t,title:r,onClose:a}=e;console.log("shareUrl",t),console.log("title",r);let{copyLink:s,shareOnTwitter:o,shareOnFacebook:i,shareOnLinkedIn:c,shareStatus:d}=w();return(0,n.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-white border rounded shadow-lg z-10 transition-transform duration-200 transform opacity-100 scale-100",children:(0,n.jsxs)("ul",{className:"py-1",children:[(0,n.jsxs)("li",{children:[(0,n.jsxs)("button",{onClick:()=>{s(t)},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(j.C3L,{className:"mr-2"})," Copy Link"]}),d.copied&&(0,n.jsx)("span",{className:"text-green-500 text-sm px-4",children:"Đ\xe3 sao ch\xe9p!"}),d.error&&(0,n.jsx)("span",{className:"text-red-500 text-sm px-4",children:d.error})]}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{o(t,r),a()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(l.fWC,{className:"mr-2 text-blue-400"})," Share on X"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{i(t),a()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(l.tBk,{className:"mr-2 text-blue-600"})," Share on Facebook"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("button",{onClick:()=>{c(t,r),a()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-gray-100 focus:outline-none",children:[(0,n.jsx)(l.BUd,{className:"mr-2 text-blue-700"})," Share on LinkedIn"]})})]})})},v=r(1087),b=e=>{let{post:t}=e;if(!t)return(0,n.jsx)("div",{children:"Đang tải b\xe0i viết..."});let{clapsCount:r,loading:s,mutate:j}=(0,x.B)("post",t.id),{user:w}=(0,u.a)(),{isBookmarked:b,toggleBookmark:N,loading:C}=(0,g.Z)(t.id),[k,_]=(0,a.useState)(!1),[Z,I]=(0,a.useState)(!1),E=(0,a.useRef)(),{comments:L,totalCommentReply:S,totalCount:U,isLoading:R,isError:B,mutate:A}=(0,f.M)(t.id,!0,1,10);(0,a.useEffect)(()=>{let e=e=>{E.current&&!E.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let P=async()=>{if(!w){alert("Bạn cần đăng nhập để clap.");return}try{console.log("clapPost:",t.id),await (0,p.nl)(t.id),j()}catch(e){console.error("Failed to clap:",e),j(),alert("Đ\xe3 xảy ra lỗi khi clap. Vui l\xf2ng thử lại sau.")}},T="http://localhost:3000/p/".concat(t.title_name);return(0,n.jsx)("div",{className:"rounded-lg p-6 mb-6 bg-white transition-shadow duration-300",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,n.jsxs)("div",{className:"w-full md:w-2/3 pr-0 md:pr-4",children:[(0,n.jsx)(h.Z,{author:t.user}),(0,n.jsx)(o(),{href:"/p/".concat(t.title_name),children:(0,n.jsx)("h5",{className:"text-lg text-gray-800 hover:text-blue-600 transition-colors duration-200 line-clamp-2",children:t.title})}),(0,n.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:(0,n.jsx)(m.Z,{html:t.preview_content,maxLength:200})}),(0,n.jsx)(d.Z,{postId:t.id}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between mt-4 space-y-2 md:space-y-0",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{onClick:P,className:"flex items-center text-gray-600 hover:text-red-500 transition-colors","aria-label":"Clap for this post",children:[(0,n.jsx)(i.sOS,{className:"mr-1"})," ",r]}),(0,n.jsxs)("button",{onClick:()=>{_(e=>!e)},className:"flex items-center text-gray-600 hover:text-blue-500 transition-colors","aria-label":"View comments",children:[(0,n.jsx)(i.RcG,{className:"mr-1"})," ",S]}),(0,n.jsxs)("span",{className:"flex items-center text-gray-600",children:[(0,n.jsx)(l.dSq,{className:"mr-1"})," ",t.views]}),(0,n.jsx)(v.Z,{timestamp:t.created_at})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{onClick:N,className:"flex items-center text-gray-600 hover:text-yellow-500 transition-colors",disabled:C,"aria-label":"Bookmark this post",children:[b?(0,n.jsx)(l.VF9,{className:"mr-1"}):(0,n.jsx)(l.mCg,{className:"mr-1"}),C&&(0,n.jsx)("span",{className:"text-sm",children:"..."})]}),(0,n.jsxs)("div",{ref:E,className:"relative",children:[(0,n.jsx)("button",{onClick:()=>{I(e=>!e)},className:"flex items-center text-gray-600 hover:text-green-500 transition-colors","aria-label":"Share this post",children:(0,n.jsx)(l.PPi,{className:"mr-1"})}),Z&&(0,n.jsx)(y,{shareUrl:T,title:t.title,onClose:()=>I(!1)})]})]})]}),(0,n.jsx)(c.Z,{isOpen:k,onClose:()=>{_(!1)},postId:t.id,user:w})]}),(0,n.jsx)("div",{className:"w-full md:w-1/3 mt-4 md:mt-0",children:t.image_title&&(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(o(),{href:"/p/".concat(t.title_name),children:(0,n.jsx)("img",{src:t.image_title,alt:t.title,className:"h-48 w-full object-cover rounded transform hover:scale-105 transition-transform duration-300"})})})})]})})}},1415:function(e,t,r){var n=r(5893);t.Z=()=>(0,n.jsx)("aside",{className:"border-gray-300 p-4"})},1888:function(e,t,r){var n=r(5893);r(7294);var a=r(8533);t.Z=e=>{let{items:t,renderItem:r,fetchMore:s,hasMore:o,loader:l,endMessage:i,className:c="grid grid-cols-1 md:grid-cols-2 gap-4"}=e;return(0,n.jsx)(a.Z,{dataLength:t.length,next:s,hasMore:o,loader:l,endMessage:i,children:(0,n.jsx)("div",{className:c,children:t.map(e=>r(e))})})}},4608:function(e,t,r){var n=r(5893);r(7294);var a=r(9238),s=r.n(a);t.Z=e=>{let{html:t,maxLength:r=200}=e,a=s().sanitize(t),o=e=>{if(!e)return"";let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""};return(0,n.jsx)("span",{children:(e=>{let t=o(e);return t.length>r?t.substring(0,r)+"...":t})(a)})}},6067:function(e,t,r){r.d(t,{CP:function(){return a},Td:function(){return o},cd:function(){return s}});var n=r(6607);let a=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=(await n.Z.get("/categories?page=".concat(e,"&limit=").concat(t))).data;if(!r||!Array.isArray(r.data)||"number"!=typeof r.total_count)throw Error("Invalid response format for getCategories");return{categories:r.data,totalCount:r.total_count}}catch(e){throw console.error("Error in getCategories:",e),e}},s=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=(await n.Z.get("/categories_top?page=".concat(e,"&limit=").concat(t))).data;if(!r||!Array.isArray(r.data)||"number"!=typeof r.total_count)throw Error("Invalid response format for getCategories");return{categories:r.data,totalCount:r.total_count}}catch(e){throw console.error("Error in getCategories:",e),e}},o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{let a=(await n.Z.get("/categories/".concat(encodeURIComponent(e),"/posts?page=").concat(t,"&limit=").concat(r))).data;if(!a||!Array.isArray(a.data)||"number"!=typeof a.total_count)throw Error("Invalid response format for getPostsByCategory");return{posts:a.data,totalCount:a.total_count}}catch(e){throw console.error("Error in getPostsByCategory:",e),e}}}}]);